const pokemonRepository=function(){const e=[];function t(t){e.push(t)}function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}function o(e){return a(),fetch(e.detailsUrl).then((e=>e.json())).then((t=>(s(),e.number=t.id,e.imageUrl=t.sprites.front_default||"img/fallback.png",e.height=t.height,e.weight=t.weight,e.types=(t.types||[]).map((e=>e.type.name)),e.stats=t.stats.map((e=>({name:e.stat.name,value:e.base_stat}))),t.species&&t.species.url?fetch(t.species.url).then((e=>e.json())).then((t=>{const n=t.flavor_text_entries.find((e=>"en"===e.language.name));e.description=n?n.flavor_text.replace(/\f/g," ").replace(/\n/g," "):"No description available."})):(console.error("Missing species data for:",e.name),void(e.description="No species description available."))))).catch((t=>{s(),console.error("Error loading details for:",e.name,t)}))}function a(){const e=document.createElement("p");e.innerText="Loading Pokémon...",e.classList.add("loading-message"),document.body.appendChild(e)}function s(){const e=document.querySelector(".loading-message");e&&e.remove()}return{add:t,getAll:function(){return e},addListItem:function(e){const t=document.querySelector(".pokemon-list"),a=document.createElement("div");a.classList.add("col-12","col-sm-6","col-md-4","col-lg-3");const s=document.createElement("div");s.classList.add("card","h-100","shadow-sm");const r=document.createElement("img");r.src=e.imageUrl,r.alt=`${e.name} image`,r.classList.add("card-img-top","p-3");const i=document.createElement("div");i.classList.add("card-body","text-center");const c=document.createElement("h5");c.classList.add("card-title"),c.innerText=`#${e.number.toString().padStart(3,"0")} ${n(e.name)}`;const l=document.createElement("div");l.classList.add("mb-2"),i.appendChild(c),i.appendChild(l),s.appendChild(r),s.appendChild(i),a.appendChild(s),t.appendChild(a),e.types&&e.types.length>0&&e.types.forEach((e=>{const t=document.createElement("span");t.innerText=n(e),t.classList.add("type-badge",`type-${e.toLowerCase()}`),l.appendChild(t)})),s.addEventListener("click",(function(){!function(e){o(e).then((function(){!function(e){const t=document.querySelector("#pokemonModalLabel"),o=document.querySelector(".modal-description"),a=document.querySelector(".modal-height"),s=document.querySelector(".modal-weight"),r=document.querySelector(".modal-types"),i=document.querySelector(".modal-image"),c=document.querySelector(".modal-stats-list");t.innerText=n(e.name),o.innerText=e.description||"No description available.",a.innerText=`Height: ${e.height}`,s.innerText=`Weight: ${e.weight}`,i.src=e.imageUrl,i.alt=e.name,r.innerHTML="",e.types.forEach((e=>{const t=document.createElement("span");t.innerText=n(e),t.classList.add("type-badge",`type-${e.toLowerCase()}`),r.appendChild(t)})),c.innerHTML="",e.stats.forEach((e=>{const t=document.createElement("li");t.innerText=`${e.name}: ${e.value}`,c.appendChild(t)}))}(e);const t=document.getElementById("pokemonModal");new bootstrap.Modal(t).show()}))}(e)}))},loadList:function(){return a(),fetch("https://pokeapi.co/api/v2/pokemon/?limit=151").then((e=>e.json())).then((e=>{s(),e.results.forEach((e=>{t({name:e.name,detailsUrl:e.url,number:parseInt(e.url.split("/").filter(Boolean).pop())})}))})).catch((e=>{s(),console.error("Error loading Pokémon list:",e)}))},loadDetails:o}}();function renderPokemonList(e=pokemonRepository.getAll()){const t=document.querySelector(".pokemon-list"),n=document.querySelector(".no-results");if(t.innerHTML="",0===e.length)return void(n.style.display="block");n.style.display="none";const o=e.map((e=>pokemonRepository.loadDetails(e)));Promise.all(o).then((()=>{e.sort(((e,t)=>e.number-t.number)),e.forEach((e=>{pokemonRepository.addListItem(e)}))}))}document.getElementById("searchInput").addEventListener("input",(function(e){const t=e.target.value.toLowerCase();renderPokemonList(pokemonRepository.getAll().filter((e=>{const n=e.name.toLowerCase().includes(t),o=e.number.toString().padStart(3,"0").includes(t),a=Array.isArray(e.types)&&e.types.some((e=>e.toLowerCase().includes(t)));return n||o||a})))})),pokemonRepository.loadList().then((()=>{renderPokemonList()}));